<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="http://61.72.187.6/script/javascript/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<script src="http://61.72.187.6/script/indicators/indicators.js"></script>
<script src="http://61.72.187.6/script/indicators/indicators10.js"></script>
<script src="http://61.72.187.6/script/indicators/indicators15.js"></script>
<script src="http://61.72.187.6/script/indicators/indicators30.js"></script>
<script src="http://61.72.187.6/script/indicators/indicators60.js"></script>
<script src="http://61.72.187.6/script/charts/weekchart.js"></script>

<div class="content-wrapper">
  <div class="container-fluid">
    <form class="form-inline my-2 my-lg-0 mr-lg-2" action="/home/weekcharts" method="get" style="float: right;">
      <div class="input-group" >
        <input class="form-control" type="text" name="name" placeholder="종목을 검색해주세요" style="float: right"/>
        <span class="input-group-append">
          <button class="btn btn-primary" type="button">
            <i class="fa fa-search"></i>
          </button>
        </span>
      </div>
    </form>
    
    <div class="btn-group" role="group" style="width:100%; margin: 0;">
      <div class="btn-group btn-group-toggle" data-toggle="radio" style="width:100%;">
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/charts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> 일
        </label>
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/weekcharts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> 주
        </label>
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/monthcharts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> 월
        </label>
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/c1charts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> C1고저차트
        </label>
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/giftcharts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> 선물차트
        </label>
        <label class="btn btn-secondary" style="width:100%;" onclick="window.location='/home/goldcharts?name=<%=@urlparam%>';">
          <input type="radio" name="buttons" style="pointer-events:none"/> 황금차트
        </label>
      </div>
    </div>

    <!-- Area Chart Example-->
    <div class="card mb-10">
      <div class="card-header" id="charts">
        <i class="fa fa-area-chart"></i>
      </div>
      <div class="card-body">
        <div id="container" style="width:100%; height: 100%; min-width: 100%; margin:0;">
      </div>
    </div>
  </div>
</div>

<script>
  var getParam = function(key){
      var _parammap = {};
      document.location.search.replace(/\??(?:([^=]+)=([^&]*)&?)/g, function () {
          function decode(s) {
              return decodeURIComponent(s.split("+").join(" "));
          }
  
          _parammap[decode(arguments[1])] = decode(arguments[2]);
      });
  
      return _parammap[key];
  };
  
  var companycode = getParam("name");
  var ajaxdata;
  
  $(document).ready(function(){
    ajaxdata = setInterval(autodata, 5000);
  });
  
  function autodata(){
    $.ajax({
      url: "http://61.72.187.6/phps/now?name=" + companycode,
      type: "GET",
      dataType: "json",
      async: false,
      success: function(data){
        var json_data = '';
        $.each(data, function(key, value){
          json_data += '<i class="fa fa-area-chart">'+value.name+'('+value.code+')'+'&nbsp&nbsp&nbsp'+value.now+'원&nbsp&nbsp&nbsp'+value.semo+'&nbsp'+value.pok+'&nbsp&nbsp'+value.per+'%</i>';
        });
        $('#charts').html(json_data);
      }
    });
  }
</script>
